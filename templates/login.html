{% extends "layout.html" %}

{% block page_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/login.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/notifications.css') }}">
{% endblock %}

{% block content %}
    <h2>Login</h2>

    <!-- Ocultamos los mensajes flash pero los guardamos para JS -->
    <div style="display: none;">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="flash-message" data-category="{{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}
    </div>

    <form method="POST" action="{{ url_for('login') }}">
        <input type="email" name="email" placeholder="Email" required><br><br>
        <input type="password" name="password" placeholder="Contraseña" required><br><br>
        <button type="submit" class="btn">Ingresar</button>
    </form>

    <!-- Formulario para reenviar verificación -->
    <div style="margin-top: 20px; padding: 15px; border-top: 1px solid #ddd;">
        <h3>¿Problemas para iniciar sesión?</h3>
        <p>Si ya te registraste pero no puedes acceder, puede que tu email no esté verificado.</p>
        
        <form method="POST" action="{{ url_for('resend_verification') }}" style="margin-top: 10px;">
            <input type="email" name="email" placeholder="Tu email" required style="padding: 8px; width: 250px;">
            <button type="submit" style="padding: 8px 15px; background-color: #ffc107; border: none; cursor: pointer;">
                Reenviar verificación
            </button>
        </form>
        <p style="font-size: 12px; color: #666; margin-top: 10px;">
            Revisa también tu carpeta de spam si no encuentras el email.
        </p>
    </div>

    <a href="{{ url_for('registro') }}">Crear cuenta</a>

    <!-- Cargar el JS al final de la página -->
    <script src="{{ url_for('static', filename='js/notifications.js') }}"></script>
{% endblock %}